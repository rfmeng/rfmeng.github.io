<!DOCTYPE html>
<html>
<head>
	<title>Moore Penrose pseudo inverse - ND Notes</title>
	<!-- from vscode markdown preview: begin -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({"extensions":["tex2jax.js"],"jax":["input/TeX","output/HTML-CSS"],"messageStyle":"none","tex2jax":{"processEnvironments":false,"processEscapes":true,"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"TeX":{"extensions":["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},"HTML-CSS":{"availableFonts":["TeX"]}});
  </script>
  <script type="text/javascript" async src="/lib/mathjax/MathJax.js" charset="UTF-8"></script>
  <script type="text/javascript" src="/lib/mermaid/mermaid.min.js" charset="UTF-8"></script>
  <!-- end -->
	<meta charset="utf-8">
	<link rel="icon" type="image/png" sizes="16x16" href="/icon/book.jpg">
	<link rel="icon" type="image/png" sizes="32x32" href="/icon/book.jpg">
	<link rel="apple-touch-icon" href="/icon/book.jpg">


	<link type="text/css" rel="styleSheet"  href="/css/index.css" />
	<link type="text/css" rel="styleSheet"  href="/css/markdown render.css" />
</head>
<body itemscope class="use-motion">
	<div class="headband"></div>
	<main class="main">
		<header class="header" style="opacity: 1; top: 0px;">
			<div class="header-inner">
				<div class="site-brand-container">
					<div class="site-meta">
				    <a href="https://rfmeng.github.io/" class="brand" rel="start">
				      <p class="site-title" style="opacity: 1; top: 0px;">Nowhere Dense</p>
				    </a>
				      <p class="site-subtitle" itemprop="description" style="opacity: 1; top: 0px;">Notes for lifelong learning</p>
				  </div>
				</div>
				<nav class="site-nav">
				  <ul class="main-menu menu">
				  	<li class="menu-item menu-item-home animated fadeInDown"><a href="/index.html" rel="section"><i class="fa fa-home fa-fw"></i>Main page</a>
				  	</li>
				  	<li class="menu-item menu-item-home animated fadeInDown">
				  		<div class="vector-search-box">
					  <div id="simpleSearch" class="vector-search-box-inner" data-search-loc="header-navigation">
							<input class="vector-search-box-input" type="search" name="search" placeholder="Search for the forgotten" aria-label="Search for the forgotten" autocapitalize="sentences" title="Search for the forgotten [alt-shift-f]" accesskey="f" id="searchInput" autocomplete="off">
							<!-- <input type="hidden" name="title" value="Special:Search"> -->
							<input id="searchButton" class="searchButton" type="submit" name="go" title="Search for content" value="Go">
						</div>
					</div>
				  	</li>

				  </ul>
				  
				  <!-- search from wikipedia -->

				</nav>
			</div>
			<aside class="sidebar animated fadeInUp">
				<div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
					<ul class="sidebar-nav">
		        <li class="sidebar-nav-toc">
		          <a href="#top">Contents</a>
		        </li>
	      	</ul>
	      	<div class="sidebar-panel-container">
	        	<div class="post-toc-wrap sidebar-panel">
	            <div class="post-toc animated">
	            	<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#nav1"><span class="nav-number">1.</span> <span class="nav-text">Definition</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#nav2"><span class="nav-number">2.</span> <span class="nav-text">Properties</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#nav2.1"><span class="nav-number">2.1.</span> <span class="nav-text">Existence and uniqueness</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nav2.2"><span class="nav-number">2.2.</span> <span class="nav-text">Linear equations</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nav2.3"><span class="nav-number">2.3.</span> <span class="nav-text">Ordinary least squares (OLS)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#nav3"><span class="nav-number">3.</span> <span class="nav-text">References</span></a></li></ol>
	            </div>
	        	</div>
	      	</div>
	      </div>
			</aside>
		</header>

		<div class="main-inner post posts-expand">
			<div class="post-block animated fadeIn">
				<article itemscope class="post-content" lang="zh-CN">
					<header class="post-header animated fadeInDown">
		        <h1 class="post-title" itemprop="name headline">
		          Moore Penrose pseudo inverse
		        </h1>
		        <div class="post-meta-container">
		          <div class="post-meta">
						    <span class="post-meta-item">
						      <span class="post-meta-item-icon">
						        <i class="far fa-calendar"></i>
						      </span>
						      <span class="post-meta-item-text">Modified</span>
						      <time title="创建时间：2022-01-12 11:10:01" itemprop="dateCreated datePublished" datetime="2022-01-12T11:10:01+00:00">2022-12-11</time>
						    </span>
						    <span class="post-meta-item">
						      <span class="post-meta-item-icon">
						        <i class="far fa-folder"></i>
						      </span>
						      <span class="post-meta-item-text">Categorized</span>
					        <span itemprop="about" itemscope="">
					          <a href="" itemprop="url" rel="index"><span itemprop="name">Proof</span></a>
					        </span>
						    </span>
							</div>
		        </div>
		      </header>
					<div class="mume markdown-preview post-body" for="html-export">
<p><ndtag category="Proof" createdate="2022-12-11" editdate="2022-12-11" tag="Linear-Algebra"></ndtag></p>
<h3 id="#nav1">Definition</h3>
<p>A matrix <span class="mathjax-exps">$A^g$</span> is pseudo inverse of <span class="mathjax-exps">$A$</span> if:<br/>
(i) <span class="mathjax-exps">$AA^gA=A$</span>, (ii) <span class="mathjax-exps">$A^gAA^g=A^g$</span>, (iii) <span class="mathjax-exps">$(AA^g)^*=AA^g$</span> and (iv) <span class="mathjax-exps">$(A^gA)^*=A^gA$</span></p>
<h3 id="#nav2">Properties</h3>
<h4 id="#nav2.1">Existence and uniqueness</h4>
<h5>Existence</h5>
<h6>Proof</h6>
<p>Let <span class="mathjax-exps">$A=U\Sigma V^*$</span> be an SVD, then <span class="mathjax-exps">$A^g=V\Sigma^gU^*$</span> will be the pseudoinverse, where <span class="mathjax-exps">$\Sigma^g$</span> takes the reciprocal of <span class="mathjax-exps">$\Sigma$</span>.</p>
<h5>Uniqueness</h5><h5>
</h5><h6>Proof</h6>
<p>Suppose <span class="mathjax-exps">$A$</span> has two pseudoinverses <span class="mathjax-exps">$B$</span> and <span class="mathjax-exps">$C$</span>, then <span class="mathjax-exps">$AB=AC$</span>, because<br/>
</p><div class="mathjax-exps">$$\begin{aligned}AB&amp;=ACAB=(AC)^*(AB)^*=C^*(ABA)^*\\ &amp;=C^*A^*=(AC)^*=AC\end{aligned}$$</div><br/>
Similarly, we have <span class="mathjax-exps">$BA=CA$</span>, then <span class="mathjax-exps">$B=BAB=BAC=CAC=C$</span>.<p></p>
<h4 id="#nav2.2">Linear equations</h4>
<h5>Theorem 1</h5> 
A solution to $Ax=b$ exists if and only if $AA^gb=b$.
<h6>Proof</h6>
The if part is easy to show.
To show the only if part, if a solution $z$ exists, then we have $Az=b$. Therefore $Az=AA^g(Az)=AA^gb$.
<h5>Theorem 2</h5>
The complete set of solutions to $Ax=b$ is give by $z=A^gb+(I-A^gA)w$ as $w$ varies all possible values.
<h6>Proof</h6>
<p>It is easy to show <span class="mathjax-exps">$z$</span> is a solution.If we show <span class="mathjax-exps">$(I-A^gA)w$</span> gives every vector in kernel space of <span class="mathjax-exps">$A$</span>, we will have all solutions.<br/>
Suppose <span class="mathjax-exps">$k$</span> is a vector in the kernel space of <span class="mathjax-exps">$A$</span>, we have <span class="mathjax-exps">$(I-A^gA)k=(k-A^gAk)=k$</span>, so every vector in the kernel space of <span class="mathjax-exps">$A$</span> can be written in the form <span class="mathjax-exps">$(I-A^gA)w$</span>.</p>
<h4 id="#nav2.3">Ordinary least squares (OLS)</h4>
<h5>Theorem 1</h5> 
$\| Ax-b\|$ is a minimum if and only if $x=A^gb+(I-A^gA)w$ for arbitrary $w\in \mathbb{R}^n$
<h6>Proof</h6>
Observe that $Ax-b=(Ax-AA^gb)-(I-AA^g)b$, then we show $(Ax-AA^gb)$ and $(I-AA^g)b$ are orthogonal:
$$\begin{aligned}
&amp;{}(Ax-AA^gb)^T(I-AA^g)b\\
=&amp;(AA^g(Ax-b))^T(I-AA^g)b\qquad\mbox{(i)} \\
=&amp;(Ax-b)^TAA^g(I-AA^g)b\qquad\mbox{(iii)}\\
=&amp;(Ax-b)^TA(A^g-A^gAA^g)b\qquad\mbox{(ii)}\\
=&amp;0
\end{aligned}$$
Then we have 
$$\begin{aligned}\|Ax-b\|^2&amp;=\|Ax-AA^gb\|^2+\|(I-AA^g)b\|^2\\
&amp;\geq\|(I-AA^g)b\|^2\end{aligned}$$
and the lower bound is attained if and only if $Ax=AA^gb$, according to linear equation property's theorem 2, this occurs for 
$$x=A^g(AA^g)b+(I-A^gA)w=A^gb+(I-A^gA)w$$
<h5>Theorem 2</h5> 
$x=A^gb$ is the unique vector of smallest euclidean norm minimizing $\|Ax-b\|$.
<h6>Proof</h6>
$$\begin{aligned}
&amp;{}(A^gb)^T(I-A^gA)w\\
=&amp;(A^gAA^gb)^T(I-A^gA)w\qquad\mbox{(ii)} \\
=&amp;(A^gb)^TA^gA(I-A^gA)w\qquad\mbox{(iv)}\\
=&amp;(A^gb)^TA^g(A-A^gA)w\qquad\mbox{(i)}\\
=&amp;0
\end{aligned}$$
Then we have $\|x\|^2\geq \|A^gb\|^2+\|(I-A^gA)w\|^2\geq \|A^gb\|^2$.
<h3 id="#nav3">References</h3>
<ul>
<li><a href="https://www.isical.ac.in/~arnabc/isivm2/pseudo.html">https://www.isical.ac.in/~arnabc/isivm2/pseudo.html</a></li>
<li><a href="https://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_inverse">https://en.wikipedia.org/wiki/Moore–Penrose_inverse</a></li>
<li><a href="https://doi.org/10.2307/3617665">https://doi.org/10.2307/3617665</a></li>
<li><a href="https://doi.org/10.2307/3617890">https://doi.org/10.2307/3617890</a></li>
</ul>
</div>
	      	<footer class="post-footer">
	          <div class="post-tags">
	          	<a href="" rel="tag"># Linear Algebra</a>
	          </div>
	          <div class="post-nav">
	            <div class="post-nav-item">
                <a href="" rel="prev">
                  < @@begin-previous article-end@@
                </a>
	            </div>
	            <div class="post-nav-item">
                <a href="" rel="next">
                  @@begin-next article-end@@ >
                </a>
	            </div>
	          </div>
					</footer>
				</article>
			</div>
		</div>
	</main>
	<footer class="footer" style="opacity: 1;">
    <div class="footer-inner" unselectable="on"; onselectstart="return false;" >
    	<div class="powered-by">怀旧空吟闻笛赋，到乡翻似烂柯人</div>
			<div class="copyright" >
			  ©<span itemprop="copyrightYear">2022</span>
			  <span class="with-love">
			    <i class="fa fa-heart"></i>
			  </span>
			  <span class="author" itemprop="copyrightHolder">Nowhere Dense</span>
			</div>
    </div>
  </footer>
</body>
</html>